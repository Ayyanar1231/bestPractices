package com.chainsys.jdbc.JDBC;

import java.beans.Statement;
import java.io.BufferedReader;
import java.io.FileInputStream;
import java.io.InputStreamReader;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.*;  


public class JDBC {
   public static void main(String[] args) {
//	   sambleJDBC();
//	   imageJDBC();
	   transferManagement();
   }
   public static void sambleJDBC() {
    try {
           Connection con  = DriverManager.getConnection("jdbc:oracle:thin:@localhost:1521:xe","system","oracle"); 
           java.sql.Statement stat = con.createStatement();
           ResultSet rs  = stat.executeQuery("select * from employees");
           while(rs.next()) {
               System.out.println(rs.getString("last_name") + ", " +rs.getString("first_name"));
           }
           con.close();
       }catch(Exception err) {
           err.printStackTrace();
       }
}
   
   public static void deleteJDBC() {
	    try {
	           Connection con  = DriverManager.getConnection("jdbc:oracle:thin:@localhost:1521:xe","system","oracle"); 
	           java.sql.Statement stat = con.createStatement();
	           ResultSet rs  = stat.executeQuery("select * from employees where name =3114");
	           
	           while(rs.next()) {
	               System.out.println(rs.getString("last_name") + ", " +rs.getString("first_name"));
	           }
	           con.close();
	       }catch(Exception err) {
	           err.printStackTrace();
	       }
   }
   
   public static void imageJDBC()
   {
   try{  
       Class.forName("oracle.jdbc.driver.OracleDriver");  
       Connection con=DriverManager.getConnection(  
       "jdbc:oracle:thin:@localhost:1521:xe","system","oracle");  
                     
       PreparedStatement ps=con.prepareStatement("insert into friend values(?,?)");  
       ps.setString(1,"Ayyanar");  
         
       FileInputStream fin=new FileInputStream("D:\\picture\\3114.jpg");  
       ps.setBinaryStream(2,fin,fin.available());  
       int i=ps.executeUpdate();  
       System.out.println(i+" records affected");  
                 
       con.close(); 
       }
   catch (Exception e) 
   {
    	   e.printStackTrace();
    	   }  
   }
     
   public static void transferManagement(){  
   try{  
     
	   Class.forName("oracle.jdbc.driver.OracleDriver");  
	   Connection con=DriverManager.getConnection("jdbc:oracle:thin:@localhost:1521:xe","system","oracle");  
	   con.setAutoCommit(false);  
	     
	   Statement stmt=con.createStatement();  
	   stmt.executeUpdate("insert into friend values(190,'abhi',40000)");  
	   stmt.executeUpdate("insert into friend values(191,'umesh',50000)");  
	     
	   con.commit();  
	   con.close();  
   }catch(Exception e) {
	   System.out.println("ERROR!!! "+e.getMessage());
   }
   } 
}
   
